#!/usr/bin/env python


#    This software is Copyright by the Board of Trustees of Michigan
#    State University (c) Copyright 2013.
#
#    You may use this software under the terms of the GNU public license
#    (GPL).  The terms of this license are described at:
#
#     http://www.gnu.org/licenses/gpl.txt
#
#    Author:
#            Ron Fox
#            NSCL
#            Michigan State University
#            East Lansing, MI 48824-1321

##
# @file   projectOpenTest.py
# @brief  Tests for the project open method.
# @author <fox@nscl.msu.edu>

import unittest
import project

class projectOpenTests(unittest.TestCase):
    def setUp(self):
        self._project = project.Project(':memory:')
    def tearDown(self):
        pass
    ##
    # test_goodOpen
    #   After a proper open we can get the connection and find e.g. the
    #   hosts table
    def test_goodOpen(self):
        self._project.create()
        self._project.open()
        conn = self._project.connection
        curs = conn.cursor()
        curs.execute(
            '''
            SELECT COUNT(*) FROM sqlite_master WHERE type='table' AND name='hosts'
            '''
        )
        self.assertEquals((1,), curs.fetchone())
    ##
    #  test_badOpen
    #    If we open a database that does not have our scheme ...an exception
    #    get thrown.
    
    def test_badOpen(self):
        thrown = False
        try:
            self._project.open()
        except RuntimeError:
            thrown = True
        except:
            pass
        self.assertTrue(thrown)
        
    

if __name__ == '__main__':
    unittest.main()