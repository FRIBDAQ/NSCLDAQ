#
#    This software is Copyright by the Board of Trustees of Michigan
#    State University (c) Copyright 2005.
#
#    You may use this software under the terms of the GNU public license
#    (GPL).  The terms of this license are described at:
#
#     http://www.gnu.org/licenses/gpl.txt
#
#     Author:
#             Ron Fox
#	     NSCL
#	     Michigan State University
#	     East Lansing, MI 48824-1321
#

#----------- Setup environment

set here [file dirname [info script]]

# starting to just get too tough to do this without
# packaging:
package require tcltest

set auto_saved $auto_path
set auto_path [concat $here $auto_path]


if {[file exists pkgIndex.tcl]} {
    file delete              pkgIndex.tcl.saved
    file rename pkgIndex.tcl pkgIndex.tcl.saved
}
pkg_mkIndex . *.tcl

package require eventData


#----------- Test utility procs


#----------- Tests:

tcltest::test 1.0 {Get entity list from scaler buffer} \
-body {
    set buffer [createScalerBuffer]
    scalerEntityFinder getEntityList $buffer
}                           \
-result {26 28 30 32 34 36 38 40 42 44}

tcltest::test 2.0 {Get entity list from event buffer} \
-body {
    set buffer [createEventBuffer [list {0 1 2 3} {0 1 2 3 4 5} {1 2}]]
    physicsEntityFinder getEntityList $buffer

}                           \
-result {16 21 28}

tcltest::test 3.0 {Get entity list from string list buffer} \
-body {
    set buffer [createStringBuffer 4 [list {set a 1234} {set bb aa} {set info junk}]]
    stringListEntityFinder getEntityList $buffer
}                         \
-result {16 22 27}


#----------- Test environment cleanup


file delete pkgIndex.tcl
if {[file exists pkgIndex.tcl.saved]} {
    file rename pkgIndex.tcl.saved pkgIndex.tcl
}
set auto_path $auto_saved


tcltest::cleanupTests
