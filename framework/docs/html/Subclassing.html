<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Sub-classing in object frameworks</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><a name="Subclassing"><h2>Sub-classing in object frameworks</h2></a>

<p>
Sub-classing is the basic mechanism which object frameworks provide the  programmer to supply application functionality. Application frameworks can be thought of as providing a complete program which does nothing. The  programmer selects classes to extend (via subclassing) and instantiates an appropriate set of objects to give the final program its functionality.
<p>
Subclassing to provide functionality consists of the following steps:<ul>
<li>Derive a class from the base class in the framework.<li>Override some of the virtual member functions of the base class to  provide the functionality you desire. It is good practice to call the base class's member from within your function in case the base class performs useful default processing.<li>Create an object of your derived class.<li>Start the object 'running'.</ul>
Consider for example the <a class="el" href="classCFileEvent.html">CFileEvent</a> class. This class provides a framework for handling events which occur as a result of a file descriptor becomming readable, writable or having an exceptional condition. (For user documentation of <a class="el" href="classCFileEvent.html">CFileEvent</a>, see <a class="el" href="FileEvents.html">the File Event handling class</a>):
<p>
<div class="fragment"><pre><font class="preprocessor">#include &lt;iostream.h&gt;</font>
<font class="preprocessor">#include &lt;stdio.h&gt;</font>
<font class="preprocessor">#include &lt;spectrodaq.h&gt;</font>
<font class="preprocessor">#include &lt;<a class="code" href="SpectroFramework_8h.html">SpectroFramework.h</a>&gt;</font>

<font class="keyword">class </font>Echo : <font class="keyword">public</font> <a class="code" href="classCFileEvent.html">CFileEvent</a>
{
<font class="keyword">public</font>:
  Echo(<font class="keywordtype">int</font> fd, <font class="keyword">const</font> <font class="keywordtype">char</font>* pName);
  <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="classCFileEvent.html#a15">OnReadable</a>(istream&amp; rin);
};

Echo::Echo(<font class="keywordtype">int</font> fd, <font class="keyword">const</font> <font class="keywordtype">char</font>* pName):
  <a class="code" href="classCFileEvent.html">CFileEvent</a>(fd, pName)
{
  AppendClassInfo();
}

<font class="keywordtype">void</font>
<a class="code" href="classCFileEvent.html#a15">Echo::OnReadable</a>(istream&amp; rin)
{
  <a class="code" href="classCFileEvent.html#a15">CFileEvent::OnReadable</a>(rin);
  string word;
  rin &gt;&gt; word;
  cout &lt;&lt; word &lt;&lt; endl;
}

<font class="keyword">class </font>MyApp : <font class="keyword">public</font> DAQROCNode
{
<font class="keyword">protected</font>:
  <font class="keyword">virtual</font> <font class="keywordtype">int</font> operator()(<font class="keywordtype">int</font> argc, <font class="keywordtype">char</font>** argv);
};

<font class="keywordtype">int</font>
MyApp::operator()(<font class="keywordtype">int</font> argc, <font class="keywordtype">char</font>** argv)
{
  Echo echo(fileno(stdin), <font class="stringliteral">"EchoProcessor"</font>);

  echo.Enable();
  DAQThreadId id = echo.getThreadId();

  Join(id);                     <font class="comment">// Wait for echo to exit.</font>
}


MyApp theapp;
</pre></div>
<p>
The class declaration for Echo defines a new class derived from <a class="el" href="classCFileEvent.html">CFileEvent</a>. In addition to implementing a constructor, this application specific class overrides <a class="el" href="classCFileEvent.html#a15">CFileEvent::OnReadable</a>. That member is called when the file descriptor represented by the object becomes readable.
<p>
The implementation of our override is to call the base class function (<a class="el" href="classCFileEvent.html#a15">CFileEvent::OnReadable</a>), and to read a string from the input file and echo it back to stdout (cout).
<p>
The application's operator() (entry point) creates an instance of echo monitoring stdin. It enables execution of the event object via a call to the object's Enable() member. Enable creates an independent thread of execution. The event serializes execution of the OnReadable member, and other user overridable members so that the programmer, for the most part, doe not need to worry about thread/thread synchronization (see <a class="el" href="Synchronization.html">Synchronizing multiple threads of execution</a>).
<p>
Once the thread is started, it's thread Id is gotten and the main program  blocks until the Event thread exits (never).
<p>
<hr><address align="right"><small>Generated on Tue Feb 4 12:35:50 2003 for Spectrodaq External Event Framework by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
