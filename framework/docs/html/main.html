<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>spectrodaq client application framework</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>spectrodaq client application framework</h1>
<p>
<h3 align="center">0.2</h3>
<p>
<dl compact><dt><b>
Author: </b><dd>
Ron Fox , Eric Kasten (Spectrodaq) , Jason Venema</dl><a name="Intro"><h2>Introduction</h2></a>

<p>
This documentation describes an application framework which simplifies the process of writing clients to spectrodaq, the NSCL data acquisition and distribution system. This set of web pages provides general documenation as well as reference information for this class library.
<p>
<a name="Starting"><h2>Getting Started</h2></a>

<p>
To write programs under the client application framework you will need to know:<ol>
<li>How to <a href="main.html#Writing">subclass the DAQROCNode class.</a><li>How to  <a href="main.html#Makefile">Write a Makefile</a>  to build your program.</ol>
<a name="Writing"><h3>Writing a subclass of DAQROCNode</h3></a>

<p>
DAQROCNode (DAQ Readout Controller Node) is the base class from which all spectrodaq clients are derived.  <div class="fragment"><pre><font class="preprocessor">#include &lt;iostream.h&gt;</font>
<font class="preprocessor">#include &lt;spectrodaq.h&gt;</font>
<font class="preprocessor">#include &lt;<a class="code" href="SpectroFramework_8h.html">SpectroFramework.h</a>&gt;</font>

<font class="keyword">class </font>MyClass : <font class="keyword">public</font> DAQROCNode
{
<font class="keyword">protected</font>:
  <font class="keywordtype">int</font> operator()(<font class="keywordtype">int</font> argc, <font class="keywordtype">char</font>** pargv);
};

<font class="keywordtype">int</font>
MyClass::operator()(<font class="keywordtype">int</font> argc, <font class="keywordtype">char</font>** pargv)
{
  cout &lt;&lt; <font class="stringliteral">"Hello World."</font> &lt;&lt; endl;
}

MyClass theApp;
</pre></div> is a minimal sample Spectrodaq client which uses the framework.
<p>
This example includes the following headers:<ul>
<li>&lt;spectrodaq.h&gt; - header which defines the spectrodaq client interface classes.<li>&lt;<a class="el" href="SpectroFramework_8h.html">SpectroFramework.h</a>&gt; - header which defines the classes in the application framwork.<li>&lt;iostream.h&gt; - Which defines classes in the C++ I/O subsystem.</ul>
The bulk of the program is the definition of a class: MyClass which extends DAQROCNode, definining and implementing the operator() member function. This member function is called when Spectrodaq has initialized and is ready to run application code. The implementation of that function simply puts the message "Hello World" to stdout.
<p>
The final line of the example declares an instance of MyClass. This instance is the application object which will actually be run by spectrodaq.
<p>
This example shows the general pattern which you must follow to write Spectrodaq clients:<ul>
<li>Include the necessary headers (&lt;spectrodaq.h&gt; &lt;<a class="el" href="SpectroFramework_8h.html">SpectroFramework.h</a>&gt; at a minimum.<li>Write a subclass to DAQROCNode which defines the behavior of your application. The entry point to the program will be the operator() member function which has the same signature as the main function. be sure not to provide an implementation of <a class="el" href="FdMonitorTest_8cpp.html#a1">main</a>() as that's provided by the spectrodaq client libraries.<li>Declare an instance of this class to provide spectrodaq with an application object to run.</ul>
<a name="Makefile"><h3>Writing a Makefile for framework programs.</h3></a>

<p>
Writing a Makefile to build your application requires:<ul>
<li>Obtaining the compilation and link flags needed by spectrodaq.<li>Listing the dependencies between modules, and build rules needed to get from indenendent to dependent half of these dependencies.</ul>
For the example in  <a href="main.html#Writing">the previous section</a>, the resulting Makefile might look like <div class="fragment"><pre>SPECTRO_FLAGS=$(shell /opt/spectrodaq/bin/spectrodaq-conf --cflags)
SPECTRO_LDFLAGS=$(shell /opt/spectrodaq/bin/spectrodaq-conf --libs)

CXXFLAGS=$(SPECTRO_FLAGS) -I/opt/daq/Include -I/usr/X11/include
LDFLAGS = $(SPECTRO_LDFLAGS) -L /opt/daq/Lib -L/usr/X11/lib \
         -lEventFramework -ltk -ltcl -lm -lXm -lXt

minimal: minimal.o
        g++ -o minimal $&lt; $(LDFLAGS)

minimal.o: minimal.cpp
        g++ -c $&lt; $(CXXFLAGS) -ltcl 
</pre></div> The first four macro definitions group together the compilation and load flags needed by spectrodaq and the  framework into two macros CXXFLAGS (compile flags), and LDFLAGS (loader  flags).
<p>
Two dependencies describe how to build the object from the source, and the executable from the object. Note that it may also be wise to  include the -ggdb flag in LDFLAGS so that you can use the gdb debugger.
<p>
<a name="Concepts"><h2>General concepts.</h2></a>

<p>
The following is a list of general concepts which are used by the event framework and should be understood.
<p>
<ul>
<li><a class="el" href="Subclassing.html">Subclassing  a base class to extend or provide functionality.</a><li><a class="el" href="Registration.html">Object registries</a> and object naming.<li><a class="el" href="EventDriven.html">Event driven programming.</a><li><a class="el" href="TCPIP.html">TCP/IP client/server programming</a>  with sockets.<li>The events which are understood by the application framework:<ol>
<li><a class="el" href="LocationMonitors.html">Location monitors:</a> Low latency monitoring of a volatile memory location.<li><a class="el" href="FileEvents.html">File descriptor events:</a> Events which occur when a file descriptor is readable or writable or has some other special condition (exception) pending.<li><a class="el" href="BufferEvent.html">Spectrodaq Buffer Events</a> Events which occur when a spectrodaq makes a buffer available to the application along a link.<li><a class="el" href="ServerEvent.html">Server accept events:</a> Events which occur when a TCP/IP server receives a connection request from a client.<li><a class="el" href="SocketEvents.html">Server Instance events:</a> Events which occur when an instance of a TCP/IP server connected to an active client receives a request from the client.</ol>
<li>Guest event loops including:<ol>
<li><a class="el" href="Synchronization.html">Synchronization of guest event loops</a> with other framework code.<li><a class="el" href="TCLGuests.html">Tcl/Tk guest event loops</a><li><a class="el" href="XtGuests.html">X11/Xt guest event loops</a></ol>
<li><a class="el" href="configsys.html">The Configuration subsystem.</a></ul>
<hr><address align="right"><small>Generated on Wed Feb 5 13:39:35 2003 for Spectrodaq External Event Framework by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
