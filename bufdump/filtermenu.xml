<?xml version="1.0" encoding="UTF-8"?>


<chapter id="chap4">
    <title>Commands on the Filter menu</title>
    <para>
        This chapter describes the options that are available
        on the Filter menu:
        <screenshot>
            <screeninfo>The file menu</screeninfo>
            <mediaobject>
                <imageobject><imagedata fileref="filtermenu.gif" format="GIF" />
                </imageobject>
                <imageobject><imagedata fileref="filtermenu.eps" format="EPS" />
                </imageobject>
            </mediaobject>
        </screenshot>
    </para>
    <para>
        When you have finished reading this chapter you will know how to:
        <itemizedlist>
            <listitem><para>
                        Set a buffer filter to select a subset of the buffers
                        in the event file.
                      </para>
            </listitem>
            <listitem><para>
                        Create a search pattern to locate text, regular
                        expressions or bit patterns within data buffers
                        that have already been read and formatted by
                        bufdump.
                      </para>
            </listitem>
            <listitem><para>
                        Repeat a previous search of the established search
                        pattern.
                      </para>
            </listitem>
        </itemizedlist>
    </para>
    <para>
        If some of the concepts and terminology described above are
        unfamiliar or unclear to you, please (re)read:
        <link linkend="chap2">Chapter 2: Introduction to bufdump concepts
        </link>
        where these concepts are described.
    </para>
    <sect1>
        <title>
            <menuchoice>
                <guimenu>Filter</guimenu>
                <guimenuitem>Filter...</guimenuitem>
            </menuchoice>
        </title>
        <para>
            The
            <menuchoice>
                <guimenu>Filter</guimenu>
                <guimenuitem>Filter...</guimenuitem>
            </menuchoice>
        menu command allows you to establish a filter on the buffers that are
        processed by bufdump.  Filters allow you to specify which buffers
        are interesting to you.  bufdump will skip buffers that do not make
        the filter criterion you establish via this command.
        </para>
        <para>
            Since there is never an end of data source on an online
            data source, exercise care in establishing filters
            on these sources.  If you read the next buffer while a
            filter is established that can never be matched, bufdump
            will hang forever ignoring buffers until you abort it.
        </para>
        <para>
            When you click on
            <menuchoice>
                <guimenu>Filter</guimenu>
                <guimenuitem>Fitler...</guimenuitem>
            </menuchoice>,
             the filter creation dialog will pop up.  This dialog is shown
             below:
             <screenshot>
                <screeninfo>The filter creation dialog</screeninfo>
                <mediaobject>
                    <imageobject><imagedata fileref="filtercallouts.gif"
                                            format="GIF" />
                    </imageobject>
                    <imageobject><imagedata fileref="filtercallouts.eps"
                                            format="EPS"
                                            scale="50" />
                    </imageobject>
                    <caption>The filter creation dialog</caption>
                </mediaobject>
            </screenshot>
        </para>
        <para>
            In the discussion that follows, the numbers
            refer to the circled numbers on the screenshot.
            <orderedlist numeration="arabic">
                <listitem><para>
                            Checking the
                            <guibutton>Enable Buffer Filtering</guibutton>
                            checkbox enables a selection of the subset
                            of buffer types.  This selection is applied
                            prior to any bit pattern matching on the contents
                            of a buffer.  When this checkbox is checked, the
                            remainder of this frame is enabled.  Select
                            the desired buffer types in the
                            <guilabel>Buffer Types</guilabel>
                            listbox and
                            click on the right arrow button to move the
                            selected buffer types to the
                            <guilabel>Accepted Types</guilabel>
                            list.
                            If you no longer wish to accept buffers of
                            a specific type, select that type in the
                            <guilabel>Accepted Types</guilabel>
                            listbox and click the left arrow button to
                            move that buffer type back to the
                            <guilabel>Buffer Types</guilabel>
                            listbox.
                          </para>
                </listitem>
                <listitem><para>
                            This section of the dialog allows you to visually
                            edit a bit patttern.  Each
                            <emphasis>x</emphasis>
                            below represents a bit.  Using the up arrow buttons
                            above and the down arrow buttons below each bit
                            you can toggle each bit between the states:
                            <variablelist>
                                <varlistentry>
                                    <term><userinput>1</userinput></term>
                                    <listitem><para>
                                                Means a match requires a 1
                                                in this bit position
                                              </para></listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><userinput>0</userinput></term>
                                    <listitem><para>
                                                Means a match requires a 0
                                                in this bit position
                                              </para></listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><userinput>x</userinput></term>
                                    <listitem><para>
                                                Means that any bit value
                                                will match in this position.
                                              </para></listitem>
                                </varlistentry>
                            </variablelist>
                        </para></listitem>
                <listitem><para>
                            Once you have finshed createing a bit pattern
                            add it to the pattern
                            list list box on the right by clicking the right
                            arrow button.
                          </para></listitem>
                <listitem><para>
                            You may alter the order of the bit patterns in this
                            listbox by selecting a pattern and clicking the
                            up or down arrow buttons  to move it
                            up or down within the list.  If you wish
                            to remove a pattern from the list select it and
                            click the <guibutton>Remove</guibutton> button.
                          </para></listitem>
                <listitem><para>
                            Bit pattern matches can be either a
                            <firstterm>Match any</firstterm>
                            criterion where a buffer is accepted if the
                            body of the buffer has a bit pattern that matches
                            any of the bit patterns in the right listbox, or
                            <firstterm>Match Sequence</firstterm>
                            where a match occurs only if a sequence of
                            words matches all of the bit patterns in the ordered
                            sequence of bit patterns in the right listbox.
                            Use these radio buttons to select which type of match
                            you want.
                        </para></listitem>
                <listitem><para>
                            This strip of the dialog has three buttons:
                            <variablelist>
                                <varlistentry>
                                    <term><guibutton>Ok</guibutton></term>
                                    <listitem><para>Accepts the filter and dismisses
                                        the dialog.  Note that the filter
                                        is applied the next time you ask bufdump
                                        to get a buffer from the data source.
                                        Data buffers already accepted and formatted
                                        remain displayed.
                                    </para></listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><guibutton>Clear</guibutton></term>
                                    <listitem><para>Clears the filter.  A cleared
                                                filter accepts all buffers.
                                              </para></listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><guibutton>Cancel</guibutton></term>
                                    <listitem><para>Dismisses the dialog without
                                                making any changes to the current
                                                filter.
                                              </para></listitem>
                                </varlistentry>
                            </variablelist>
                        </para></listitem>
            </orderedlist>
        </para>
    </sect1>
    <sect1>
        <title>
            <menuchoice>
                <shortcut>
                    <keycombo><keycap>Ctrl</keycap><keycap>F</keycap></keycombo>
                </shortcut>
                <guimenu>Filter</guimenu>
                <guimenuitem>Search...</guimenuitem>
            </menuchoice>
        </title>
        <para>
            The
            <menuchoice>
                <shortcut>
                    <keycombo><keycap>Ctrl</keycap><keycap>F</keycap></keycombo>
                </shortcut>
                <guimenu>Filter</guimenu>
                <guimenuitem>Search...</guimenuitem>
            </menuchoice>
            command allows you to establish a search pattern for the data
            that has already been formatted by the bufdump program.
            The command also does an initial search for this pattern.
        </para>
        <para>
            The search pattern can search either for exact matches to
            text strings in the formatted buffer, to matches for regular
            expressions or for bit patterns or sequences of bit patterns.
        </para>
        <para>
            The menu command brings up the search dialog shown below.
            <screenshot>
                <screeninfo>The search dialog</screeninfo>
                <mediaobject>
                    <imageobject><imagedata fileref="searchcallouts.gif"
                                            format="GIF" />
                    </imageobject>
                    <imageobject><imagedata fileref="searchcallouts.eps"
                                            format="EPS"
                                            scale="50" />
                    </imageobject>
                    <caption>The search dialog</caption>
                </mediaobject>
            </screenshot>
        </para>
        <para>
            The numbers in the list below refer to the numbers on the figure above:
            <orderedlist>
                <listitem><para>
                            You may enter strings for text searches in this
                            text entry box.  Note that text entry is only
                            enabled when a text search is selected (see
                            6 below).
                          </para></listitem>
                <listitem><para>
                            The radio buttons to the right allow you to
                            select between an exact textual search or a search
                            for a regular expression.  An example of a
                            regular expression string is [Ee]vent which
                            matches either "Event" or "event".  The full
                            syntax definition of regular expressions is
                            powerful and complex.  A discussion of this
                            syntax is beyond the scope of this document.
                            Refer either to the unix regex(7) man page or
                            the documentation of the Tcl regexp command
                            in any Tcl book for more information about
                            regular expressions.
                            </para></listitem>
                <listitem><para>
                            This section of the dialog allows you to visually
                            edit a bit patttern.  This section of the dialog is
                            only enabled if the
                            <emphasis>Bit Pattern Search</emphasis>
                            radio button is selected.
                            Each
                            <emphasis>x</emphasis>
                            below represents a bit.  Using the up arrow buttons
                            above and the down arrow buttons below each bit
                            you can toggle each bit between the states:
                            <variablelist>
                                <varlistentry>
                                    <term><userinput>1</userinput></term>
                                    <listitem><para>
                                                Means a match requires a 1
                                                in this bit position
                                              </para></listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><userinput>0</userinput></term>
                                    <listitem><para>
                                                Means a match requires a 0
                                                in this bit position
                                              </para></listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><userinput>x</userinput></term>
                                    <listitem><para>
                                                Means that any bit value
                                                will match in this position.
                                              </para></listitem>
                                </varlistentry>
                            </variablelist>
                            Once you have finished creating a bit pattern,
                            it can be added to the set of match patterns by
                            clicking the right arrow button.
                        </para></listitem>
                <listitem><para>
                            You may alter the order of bit patterns
                            by selecting a pattern and clicking the
                            up or down arrow buttons here to move it
                            up or down within the list.  If you wish
                            to remove a pattern from the list select it and
                            click the <guibutton>Remove</guibutton> button.
                          </para></listitem>
                <listitem><para>
                            Bit pattern matches can be either a
                            <firstterm>Match any</firstterm>
                            criterion where a buffer is accepted if the
                            content of the buffer has a bit pattern that matches
                            any of the bit patterns in the right listbox, or
                            <firstterm>Match Sequence</firstterm>
                            where a match is only declared if a sequence of
                            words matches all of the bit patterns in the ordered
                            sequence of bit patterns in the right listbox.
                            Use these radio buttons to select which type of match
                            you want.
                        </para></listitem>
                <listitem><para>
                            These radio buttons allow you to select the
                            search type.  Selecting one of them enables
                            the appropriate part of the dialog, and disables
                            the inappropriate part.
                          </para></listitem>
                <listitem><para>
                            The buttons in this frame operate as follows:
                            <variablelist>
                                <varlistentry>
                                    <term><guibutton>Ok</guibutton></term>
                                    <listitem><para>
                                        Accepts the search pattern,
                                        and performs a search from the beginning
                                        of the formatted data for the first match
                                        on the new search pattern.
                                        </para>
                                    </listitem>
                                </varlistentry>
                                <varlistentry>
                                    <term><guibutton>Cancel</guibutton></term>
                                    <listitem><para>
                                        Dismisses the dialog and neither changes
                                        the search pattern nor performs a search.
                                    </para></listitem>
                                </varlistentry>
                            </variablelist>
                            </para>
                </listitem>
            </orderedlist>
        </para>
        <para>
            When a search pattern matches, it is brought into the displayed
            part of the formatted data and the section that matches is highlighted.
            This highlighting is not exact, however the first element
            highlighted corresponds to the start of the match.
            The picture below shows a match on the bit pattern sequence:
            <programlisting>
            0101 1000 xxxx xxxx, 0000 0000 0000 0001:
            </programlisting>
        </para>
        <para>
            <screenshot>
                <screeninfo>A bit sequence match</screeninfo>
                <mediaobject>
                    <imageobject><imagedata fileref="seqmatch.gif"
                                            format="GIF" />
                    </imageobject>
                    <imageobject><imagedata fileref="seqmatch.eps"
                                            format="EPS" />
                    </imageobject>
                    <caption>A bit sequence match</caption>
                </mediaobject>
            </screenshot>
        </para>
    </sect1>
    <sect1>
        <title>
            <menuchoice>
                <shortcut>
                    <keycombo><keycap>F3</keycap></keycombo>
                </shortcut>
                <guimenu>Filter</guimenu>
                <guimenuitem>Search Next</guimenuitem>
            </menuchoice>
        </title>
        <para>
            The
            <menuchoice>
                <shortcut>
                    <keycombo><keycap>F3</keycap></keycombo>
                </shortcut>
                <guimenu>Filter</guimenu>
                <guimenuitem>Search Next</guimenuitem>
            </menuchoice>
            command repeats the search with the current search pattern.
            If no search pattern has been established yet, an error message
            is displayed.
        </para>
    </sect1>

</chapter>
