
package require tcltest


tcltest::test pkgrequire-0 {verify that the package can be required
} {package require mcfd16statelogger} 1.0

set testDir [tcltest::makeDirectory .test]
proc setup {} {
  set ::logFile [tcltest::makeFile {} logger.out $::testDir]
  MCFD16CommandLogger ::logger $::logFile -name ::dev
}

proc tearDown {} {
  tcltest::removeFile $::logFile
  ::logger destroy
}

tcltest::test threshold-0 {Setting threshold gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  ::logger SetThreshold 0 12
  ::logger SetThreshold 1 23
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev SetThreshold 0 12
::dev SetThreshold 1 23}

tcltest::test gain-0 {Setting gain gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  # the below are actually not reasonable gain values but the logger
  # is not designed to check. It is just intended to log commands.
  ::logger SetGain 0 12
  ::logger SetGain 1 23
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev SetGain 0 12
::dev SetGain 1 23}

tcltest::test width-0 {Setting width gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  # the below are actually not reasonable values but the logger
  ::logger SetWidth 0 12
  ::logger SetWidth 1 23
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev SetWidth 0 12
::dev SetWidth 1 23}

tcltest::test deadtime-0 {Setting deadtime gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  # the below are actually not reasonable gain values but the logger
  # is not designed to check. It is just intended to log commands.
  ::logger SetDeadtime 0 12
  ::logger SetDeadtime 1 23
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev SetDeadtime 0 12
::dev SetDeadtime 1 23}

tcltest::test delay-0 {Setting delay gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  # the below are actually not reasonable gain values but the logger
  # is not designed to check. It is just intended to log commands.
  ::logger SetDelay 0 12
  ::logger SetDelay 1 23
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev SetDelay 0 12
::dev SetDelay 1 23}

tcltest::test fraction-0 {Setting fraction gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  # the below are actually not reasonable gain values but the logger
  # is not designed to check. It is just intended to log commands.
  ::logger SetFraction 0 12
  ::logger SetFraction 1 23
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev SetFraction 0 12
::dev SetFraction 1 23}

tcltest::test polarity-0 {Setting polarity gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  # the below are actually not reasonable gain values but the logger
  # is not designed to check. It is just intended to log commands.
  ::logger SetPolarity 0 12
  ::logger SetPolarity 1 23
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev SetPolarity 0 12
::dev SetPolarity 1 23}

tcltest::test mode-0 {Setting mode gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  # the below are actually not reasonable gain values but the logger
  # is not designed to check. It is just intended to log commands.
  ::logger SetMode mode
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev SetMode mode}

tcltest::test rc-0 {Enabling rc gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  # the below are actually not reasonable gain values but the logger
  # is not designed to check. It is just intended to log commands.
  ::logger EnableRC true
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev EnableRC true}

tcltest::test channelmask-0 {Setting channel mask gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {
  # the below are actually not reasonable gain values but the logger
  # is not designed to check. It is just intended to log commands.
  ::logger SetChannelMask 234
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev SetChannelMask 234}

tcltest::test pulser-0 {Enabling pulser gets written to file
} -setup {
  setup
} -cleanup {
  tearDown
} -body {

  ::logger EnablePulser 2
  ::logger Flush
    
  tcltest::viewFile $::logFile
} -result {::dev EnablePulser 2}

tcltest::cleanupTests
